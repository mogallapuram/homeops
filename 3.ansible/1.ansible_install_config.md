
# ðŸ§© Complete Ansible Setup Guide â€” Ram @ ansible (with Timezone & Linting)

This document describes the full setup for managing **Ubuntu 25.10** systems using **Ansible**.  
It includes SSH setup, the Ansible Starter Kit, timezone configuration (default: **Asia/Dubai**), and linting practices.

---

## ðŸš€ 1. Install Ansible (Control Node)

Run these on your `ansible` control node:

```bash
sudo apt update && sudo apt -y upgrade
sudo apt -y install software-properties-common git curl python3 python3-venv pipx
sudo add-apt-repository --yes --update ppa:ansible/ansible
sudo apt -y install ansible
ansible --version
```

---

## ðŸ§¹ 2. Install Ansible-Lint (Quality Checks)

`ansible-lint` ensures your playbooks follow clean YAML syntax and Ansible best practices.

```bash
pipx install ansible-lint
pipx ensurepath
source ~/.bashrc
ansible-lint --version
```

You can lint all playbooks anytime:
```bash
ansible-lint
```

---

## ðŸ” 3. SSH Key Setup â€” Why **ssh-ed25519**

| Feature | Benefit |
|----------|----------|
| Security | As strong as RSAâ€‘4096 but smaller (256â€‘bit) |
| Speed | Faster key generation and authentication |
| Safety | Uses a modern elliptic curve (Curve25519) |
| Efficiency | Lightweight â€” perfect for automation |

Generate your key:
```bash
ssh-keygen -t ed25519 -C "ram@ansible" -f ~/.ssh/id_ed25519
```

If password login is disabled, you can copy the key manually:
```bash
cat ~/.ssh/id_ed25519.pub  # copy this line

# On target node
mkdir -p ~/.ssh && chmod 700 ~/.ssh
echo "ssh-ed25519 AAAA... ram@ansible" >> ~/.ssh/authorized_keys
chmod 600 ~/.ssh/authorized_keys
```

Verify:
```bash
ssh -i ~/.ssh/id_ed25519 ram@10.10.11.1
```

---

## âš™ï¸ 4. Ansible Starter Kit

Untar and set up your preconfigured starter which will be available in the :
```bash
tar -xvf ansible-starter.tar
cd ~/ansible
ansible-galaxy collection install -r requirements.yml
```

Folder layout:
```
ansible/
â”œâ”€â”€ ansible.cfg
â”œâ”€â”€ group_vars/
â”œâ”€â”€ inventories/
â”œâ”€â”€ playbooks/
â”‚   â”œâ”€â”€ bootstrap.yml
â”‚   â”œâ”€â”€ ping.yml
â”‚   â”œâ”€â”€ upgrade.yml
â”œâ”€â”€ requirements.yml
â””â”€â”€ README.md
```

---

## ðŸ§© 5. Inventory Example

```ini
[controllers]
k3s-ctrl-1 ansible_host=10.10.11.1
k3s-ctrl-2 ansible_host=10.10.11.2

[workers]
k3s-node-1 ansible_host=10.10.11.4

[all:vars]
ansible_user=ram ##change the user based on your user
ansible_ssh_private_key_file=/home/ram/.ssh/id_ed25519  #adjust the path accordingly
ansible_become=true
ansible_become_method=sudo
```

---

## ðŸ•’ 6. Default Timezone â€” Asia/Dubai ðŸ‡¦ðŸ‡ª

By default, all systems in the Ansible Starter Pack are configured to use the **Asia/Dubai (GST, +04:00)** timezone.

If you are in another region, you can easily modify the timezone setting in:
```bash
group_vars/all.yml
```

Example:
```yaml
# Default timezone â€” change this if needed
timezone: "Asia/Dubai"
```

### ðŸ” Finding Your Timezone

To list all available timezones on Ubuntu:
```bash
timedatectl list-timezones
```

To filter by region:
```bash
timedatectl list-timezones | grep Asia
timedatectl list-timezones | grep Europe
timedatectl list-timezones | grep America
```

**Common examples:**

| Country | City | Timezone |
|----------|------|-----------|
| ðŸ‡¦ðŸ‡ª UAE | Dubai | `Asia/Dubai` |
| ðŸ‡®ðŸ‡³ India | Kolkata | `Asia/Kolkata` |
| ðŸ‡¸ðŸ‡¦ Saudi Arabia | Riyadh | `Asia/Riyadh` |
| ðŸ‡¸ðŸ‡¬ Singapore | Singapore | `Asia/Singapore` |
| ðŸ‡¬ðŸ‡§ UK | London | `Europe/London` |
| ðŸ‡ºðŸ‡¸ USA (East) | New York | `America/New_York` |
| ðŸ‡¦ðŸ‡º Australia | Sydney | `Australia/Sydney` |

### âœ… Verify the Change
After running your bootstrap playbook:
```bash
ansible all -m command -a "timedatectl show -p Timezone --value"
```
Expected result (for UAE):
```
Asia/Dubai
```

---
packages_common:
  - curl
  - vim
  - htop
  - net-tools
  - python3
```

Run the baseline setup:
```bash
ansible-playbook playbooks/bootstrap.yml
```

---

## ðŸ”„ 7. Ubuntu Upgrade Playbook (Optional)

For safe upgrades and reboots:
```bash
ansible-playbook playbooks/upgrade.yaml
```

---

## ðŸ§ª 8. Validate Playbooks with Linting

Check your playbooks before applying:
```bash
ansible-lint playbooks/bootstrap.yml
ansible-lint playbooks/upgrade.yaml
```

(Optional) add a Git hook:
```bash
cat > .git/hooks/pre-commit <<'EOF'
#!/bin/bash
echo "ðŸ” Running ansible-lint before commit..."
ansible-lint || { echo "âŒ ansible-lint failed. Fix warnings before committing."; exit 1; }
EOF
chmod +x .git/hooks/pre-commit
```

---

## âœ… 9. Summary

| Step | Task |
|------|------|
| 1ï¸âƒ£ | Install Ansible + ansible-lint |
| 2ï¸âƒ£ | Configure SSH with ED25519 keys |
| 3ï¸âƒ£ | Deploy the Ansible Starter Kit |
| 4ï¸âƒ£ | Use `Asia/Dubai` timezone (changeable in vars) |
| 5ï¸âƒ£ | Run playbooks and verify with `ansible-lint` |

---

**Author:** Ram @ ansible  
**Date:** October 2025  
**Purpose:** Automate Ubuntu 25.10 homelab with secure SSH, clean playbooks, and consistent timezone configuration.
